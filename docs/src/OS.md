

**操作系统（Operating System, OS）**：是管理计算机硬件和软件资源的计算机程序，提供一个计算机用户与计算机硬件系统之间的接口。向上对用户程序提供接口，向下接管硬件资源。操作系统本质上也是一个软件，作为最接近硬件的系统软件，负责处理器管理、存储器管理、设备管理、文件管理和提供用户接口。

## 堆栈

堆和栈的区别：

- 栈区（stack）：由编译器自动分配和释放，存放函数的参数值、局部变量的值等。其操作方式类似于数据结构的栈；
- 堆区（heap）：一般由程序员分配和释放，若程序员不释放，程序结束时可能由操作系统回收。需要手动使用 `new`, `malloc`, `delete`, `free` 进行分配和回收，空间较大，但可能会出现内存泄漏和空闲碎片的情况。它与数据结构中的堆是两回事，分配方式类似于链表；

- 申请方式：

  - 栈：**由系统自动分配。**例如在声明函数的一个局部变量 `int b`，系统会自动在栈中为 `b` 开辟空间；

  - 堆：**需要程序员自己申请，并指明大小。**在 C 中用 `maclloc` 函数申请，在 C++ 中用 `new` 操作符；

- 申请后系统的响应：
  - 栈：只要栈的剩余空间大于所申请的空间，系统将为程序提供内存，否则将报异常提示栈溢出；
  - 堆：操作系统有一个记录空间内存地址的链表，当系统收到程序的申请时，会遍历链表，寻找第一个空间大于所申请空间的堆结点，然后将节点从内存空闲节点链表中删除，并将该节点的空间分配给程序。对于大多数操作系统，会在这块内存空间中的首地址处记录本次分配的大小。这样，代码中的 `delete` 语句才能正确地释放本地内存空间。另外，由于找到的堆节点的大小不一定正好等于申请的大小，系统会自动地将多余的那部分重新放入到链表中。
- 申请大小的限制：
  - 栈：在 Windows 下，栈是向低地址拓展的数据结构，是一块连续的内存的区域。栈的地址和栈的大小是系统预先规定好的，如果申请的内存空间超过栈的剩余空间，将提升栈溢出。**栈的空间有限**；
  - 堆：是向高地址拓展的内存结构，是不连续的内存区域。是系统用链表存储空闲内存地址的，不连续。**堆是很大的自由内存区**；
- 申请效率的比较：
  - 栈：由系统自动分配，速度较快，但程序员无法控制；
  - 堆：由 `new` 分配的内存，一般速度比较慢，而且容易产生内存碎片，不过用起来方便；
  - 拓展：在 Windows 操作系统中，最好的方式是用 `VirtualAlloc` 分配内存。不是在堆，不是在栈，而是在内存空间中保留一块内存，虽然用起来不方便，但是速度快，也很灵活；
- 堆和栈的存储内容：
  - 栈：在函数调用时，第一个进栈的是主函数中的下一条指令（函数调用的下一个可执行语句）的地址，然后是函数的各个参数。在 C 编译器中，参数是由右往左入栈的，然后是函数的局部变量，静态变量不入栈；
  - 堆：一般是在堆的头部用一个字节存放堆的大小。堆中的具体内容由程序员安排。

- 总结：
  - 栈的空间由操作系统自动分配以及释放；堆的空间是程序员手动分配以及释放的；
  - 栈的空间有限；堆是很大的自由内存区；
  - C 中的 `maclloc` 函数分配的内存空间就在堆上；C++ 中对应的是 `new` 操作符；

除了栈区和堆区之外，还有：

- 全局/静态存储区：全局变量和静态变量的存储是放在一起的，初始化的全局变量和静态变量在一块区域，未初始化的全局变量和未初始化的静态变量在相邻的另外一块区域。程序结束后由系统释放；
- 文字常量区：常量字符串存放的位置，一般不允许修改，程序结束之后由系统释放；
- 程序代码区：存放函数体的二进制代码；

## 资料

https://gitee.com/autoencoder/interviewtop/blob/master/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.md

[操作系统八股文背诵版 - 互联网面试八股文](https://zhuanlan.zhihu.com/p/373966882)
